import{a as g}from"./chunk-B3POKIM7.js";import{O as c,S as l,a as d,b as p,d as i}from"./chunk-HYY45DGL.js";var f=class s{constructor(o){this.firebaseService=o}getAll(){return i(this,null,function*(){return yield this.firebaseService.loadExpenses()})}add(o){return i(this,null,function*(){try{console.log("Adding expense to Firebase...");let e=yield this.firebaseService.addExpense(o);return console.log(`Expense added with ID: ${e}`),e}catch(e){throw console.error("Error adding expense:",e),e}})}update(o){return i(this,null,function*(){try{console.log(`Updating expense with ID: ${o.id}`),yield this.firebaseService.updateExpense(o),console.log("Expense updated successfully")}catch(e){throw console.error("Error updating expense:",e),e}})}delete(o){return i(this,null,function*(){try{console.log(`Deleting expense with ID: ${o}`),yield this.firebaseService.deleteExpense(o),console.log("Expense deleted successfully")}catch(e){throw console.error("Error deleting expense:",e),e}})}deleteByCategoryId(o){return i(this,null,function*(){try{let t=(yield this.firebaseService.loadExpenses()).filter(r=>r.categoryId===o);for(let r of t)yield this.firebaseService.deleteExpense(r.id)}catch(e){throw console.error("Error deleting expenses by category:",e),e}})}getById(o){return i(this,null,function*(){return(yield this.firebaseService.loadExpenses()).find(t=>t.id===o)})}getByCategoryId(o){return i(this,null,function*(){return this.firebaseService.getExpensesByCategory(o)})}getByDateRange(o,e){return i(this,null,function*(){return this.firebaseService.getExpensesByDateRange(o,e)})}static \u0275fac=function(e){return new(e||s)(l(g))};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};var u=class s{constructor(o){this.firebaseService=o;this.initializeDefaultCategories()}initializeDefaultCategories(){return i(this,null,function*(){if((yield this.firebaseService.loadCategories()).length===0){let e=this.getDefaultCategories();for(let t of e)yield this.firebaseService.addCategory(t)}})}forceInitializeDefaultCategories(){return i(this,null,function*(){console.log("Force initializing default categories...");let o=this.getDefaultCategories();for(let e of o)yield this.firebaseService.addCategory(e);console.log("Default categories initialized successfully")})}getDefaultCategories(){return[{name:"Food & Dining",color:"#A62C2C",icon:"\u{1F355}"},{name:"Transportation",color:"#E83F25",icon:"\u{1F699}"},{name:"Shopping",color:"#EA7300",icon:"\u{1F6D2}"},{name:"Entertainment",color:"#D3CA79",icon:"\u{1F3AD}"},{name:"Bills & Utilities",color:"#FF6B6B",icon:"\u26A1"},{name:"Healthcare",color:"#4ECDC4",icon:"\u{1F3E5}"},{name:"Education",color:"#45B7D1",icon:"\u{1F393}"},{name:"Rent/Mortgage",color:"#96CEB4",icon:"\u{1F3D8}\uFE0F"},{name:"Insurance",color:"#FF8E53",icon:"\u{1F6E1}\uFE0F"},{name:"Savings",color:"#2ECC71",icon:"\u{1F48E}"},{name:"Travel",color:"#9B59B6",icon:"\u2708\uFE0F"},{name:"Fitness & Sports",color:"#E74C3C",icon:"\u{1F3C3}"},{name:"Personal Care",color:"#F39C12",icon:"\u{1F484}"},{name:"Gifts & Donations",color:"#E91E63",icon:"\u{1F381}"},{name:"Technology",color:"#34495E",icon:"\u{1F4BB}"},{name:"Pet Care",color:"#8E44AD",icon:"\u{1F415}"},{name:"Other",color:"#95A5A6",icon:"\u{1F4CC}"}]}getAll(){return i(this,null,function*(){let o=yield this.firebaseService.loadCategories(),e=this.removeDuplicateCategories(o);return e.length!==o.length&&(console.log(`Found ${o.length-e.length} duplicate categories. Cleaning up...`),yield this.cleanupDuplicateCategories(e)),e})}removeDuplicateCategories(o){let e=new Set,t=[];for(let r of o){let a=r.name.toLowerCase().trim();e.has(a)?console.log(`Duplicate category found: "${r.name}" (ID: ${r.id})`):(e.add(a),t.push(r))}return t}cleanupDuplicateCategories(o){return i(this,null,function*(){try{let e=yield this.firebaseService.loadCategories(),t=new Set,r=[];for(let a of e){let n=a.name.toLowerCase().trim();t.has(n)?(r.push(a.id),console.log(`Marking duplicate for deletion: "${a.name}" (ID: ${a.id})`)):t.add(n)}for(let a of r)try{yield this.firebaseService.deleteCategory(a),console.log(`Deleted duplicate category with ID: ${a}`)}catch(n){console.error(`Error deleting duplicate category ${a}:`,n)}}catch(e){console.error("Error cleaning up duplicate categories:",e)}})}add(o){return i(this,null,function*(){try{return yield this.firebaseService.addCategory(o)}catch(e){throw console.error("Error adding category:",e),e}})}update(o){return i(this,null,function*(){try{console.log(`Updating category with ID: ${o.id}`),yield this.firebaseService.updateCategory(o),console.log("Category updated successfully")}catch(e){throw console.error("Error updating category:",e),e}})}delete(o){return i(this,null,function*(){try{console.log(`Deleting category with ID: ${o}`);let t=(yield this.firebaseService.loadExpenses()).filter(r=>r.categoryId===o);console.log(`Found ${t.length} expenses to delete for category ${o}`);for(let r of t)yield this.firebaseService.deleteExpense(r.id);yield this.firebaseService.deleteCategory(o),console.log("Category deleted successfully")}catch(e){throw console.error("Error deleting category:",e),e}})}getById(o){return i(this,null,function*(){return(yield this.firebaseService.loadCategories()).find(t=>t.id===o)})}triggerDuplicateCleanup(){return i(this,null,function*(){console.log("Manual duplicate cleanup triggered...");let o=yield this.getAll();console.log(`Categories after cleanup: ${o.length}`)})}updateCategoryIcons(){return i(this,null,function*(){console.log("Updating category icons...");let o=yield this.getAll(),e={"Food & Dining":"\u{1F355}",Transportation:"\u{1F699}",Shopping:"\u{1F6D2}",Entertainment:"\u{1F3AD}","Bills & Utilities":"\u26A1",Healthcare:"\u{1F3E5}",Education:"\u{1F393}","Rent/Mortgage":"\u{1F3D8}\uFE0F",Insurance:"\u{1F6E1}\uFE0F",Savings:"\u{1F48E}",Travel:"\u2708\uFE0F","Fitness & Sports":"\u{1F3C3}","Personal Care":"\u{1F484}","Gifts & Donations":"\u{1F381}",Technology:"\u{1F4BB}","Pet Care":"\u{1F415}",Movie:"\u{1F3AC}",Loan:"\u{1F4B3}",SIP:"\u{1F4C8}","Street food":"\u{1F32E}",Snooker:"\u{1F3B1}",Tax:"\u{1F4CA}",Trips:"\u{1F9F3}",EMI:"\u{1F3E6}",Fuel:"\u26FD","Office canteen":"\u{1F37D}\uFE0F"},t=0;for(let r of o){console.log(`Checking category: "${r.name}" with current icon: "${r.icon}"`);let a=e[r.name];if(a&&r.icon!==a)try{let n=p(d({},r),{icon:a});yield this.update(n),t++,console.log(`\u2705 Updated icon for "${r.name}" from "${r.icon}" to "${a}"`)}catch(n){console.error(`\u274C Error updating icon for "${r.name}":`,n)}else console.log(a?`\u23ED\uFE0F Category "${r.name}" already has the correct icon: "${r.icon}"`:`\u2753 No icon mapping found for category: "${r.name}"`)}return console.log(`Updated ${t} category icons`),t})}static \u0275fac=function(e){return new(e||s)(l(g))};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};export{f as a,u as b};
