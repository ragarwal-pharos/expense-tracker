import{g as S,i as R}from"./chunk-LK6VNFKO.js";import{Aa as u,Ec as k,Ga as b,Gc as E,Hc as I,Ic as T,Ja as h,Jc as V,Kc as N,Lc as z,Mc as A,Nc as q,Qb as M,Tc as F,Ua as c,Uc as j,Va as e,Wa as t,Wb as O,Wc as D,Ya as f,Z as m,Za as w,_ as g,_a as l,cb as v,d as _,gb as r,ib as y,lb as C,mb as x,nb as P,wa as d}from"./chunk-BZFO6NJ3.js";function Y(s,n){s&1&&(e(0,"span",24),r(1,"\u23F3"),t())}function W(s,n){s&1&&(e(0,"span"),r(1,"Reset Password"),t())}function B(s,n){if(s&1){let o=f();e(0,"div",12)(1,"p",13),r(2," Enter your new password below. Make sure it's secure and easy to remember. "),t(),e(3,"form",14,0),w("ngSubmit",function(){m(o);let a=l();return g(a.resetPassword())}),e(5,"div",15)(6,"label",16),r(7,"New Password"),t(),e(8,"input",17),P("ngModelChange",function(a){m(o);let p=l();return x(p.password,a)||(p.password=a),g(a)}),t()(),e(9,"div",15)(10,"label",18),r(11,"Confirm New Password"),t(),e(12,"input",19),P("ngModelChange",function(a){m(o);let p=l();return x(p.confirmPassword,a)||(p.confirmPassword=a),g(a)}),t()(),e(13,"div",20)(14,"button",21),h(15,Y,2,0,"span",22)(16,W,2,0,"span",23),t()()()()}if(s&2){let o=v(4),i=l();d(8),C("ngModel",i.password),d(4),C("ngModel",i.confirmPassword),d(2),c("disabled",!o.form.valid||i.loading||!i.passwordsMatch()),d(),c("ngIf",i.loading),d(),c("ngIf",!i.loading)}}function G(s,n){if(s&1){let o=f();e(0,"div",25)(1,"div",26),r(2,"\u2705"),t(),e(3,"h3",27),r(4,"Password Reset Successful!"),t(),e(5,"p",28),r(6," Your password has been successfully reset. You can now sign in with your new password. "),t(),e(7,"div",29)(8,"button",30),w("click",function(){m(o);let a=l();return g(a.goToLogin())}),r(9," Sign In Now "),t()()()}}function H(s,n){if(s&1){let o=f();e(0,"div",31)(1,"div",32),r(2,"\u274C"),t(),e(3,"h3",33),r(4,"Invalid Reset Link"),t(),e(5,"p",34),r(6," This password reset link is invalid or has expired. Please request a new reset link. "),t(),e(7,"div",35)(8,"button",36),w("click",function(){m(o);let a=l();return g(a.goToForgotPassword())}),r(9," Request New Link "),t()()()}}function J(s,n){if(s&1&&(e(0,"div",37),r(1),t()),s&2){let o=l();d(),y(" ",o.error," ")}}var L=class s{constructor(n,o,i){this.authService=n;this.router=o;this.route=i}password="";confirmPassword="";loading=!1;resetSuccess=!1;invalidCode=!1;error="";oobCode="";ngOnInit(){this.route.queryParams.subscribe(n=>{this.oobCode=n.oobCode,this.oobCode?this.verifyResetCode():(this.invalidCode=!0,this.error="No reset code provided. Please use the link from your email.")})}verifyResetCode(){return _(this,null,function*(){try{yield E(this.authService.getAuthInstance(),this.oobCode)}catch(n){this.invalidCode=!0,this.error=this.getErrorMessage(n)}})}resetPassword(){return _(this,null,function*(){if(!this.passwordsMatch()){this.error="Passwords do not match. Please try again.";return}if(this.password.length<6){this.error="Password must be at least 6 characters long.";return}this.loading=!0,this.error="";try{yield k(this.authService.getAuthInstance(),this.oobCode,this.password),this.resetSuccess=!0}catch(n){this.error=this.getErrorMessage(n)}finally{this.loading=!1}})}passwordsMatch(){return this.password===this.confirmPassword&&this.password.length>0}goToLogin(){this.router.navigate(["/login"])}goToForgotPassword(){this.router.navigate(["/forgot-password"])}getErrorMessage(n){return n.code==="auth/expired-action-code"?"The password reset link has expired. Please request a new one.":n.code==="auth/invalid-action-code"?"The password reset link is invalid. Please request a new one.":n.code==="auth/weak-password"?"Password is too weak. Please choose a stronger password.":n.code==="auth/network-request-failed"?"Network error. Please check your internet connection and try again.":"An error occurred while resetting your password. Please try again."}static \u0275fac=function(o){return new(o||s)(u(I),u(R),u(S))};static \u0275cmp=b({type:s,selectors:[["app-reset-password"]],decls:14,vars:4,consts:[["resetForm","ngForm"],[1,"reset-password-container"],[1,"reset-password-card"],[1,"reset-password-header"],[1,"brand"],[1,"brand-icon"],[1,"brand-title"],[1,"reset-password-subtitle"],["class","reset-password-form",4,"ngIf"],["class","success-message",4,"ngIf"],["class","error-message",4,"ngIf"],["class","error-notification",4,"ngIf"],[1,"reset-password-form"],[1,"instruction-text"],[1,"reset-form",3,"ngSubmit"],[1,"form-group"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","","minlength","6","placeholder","Enter your new password (min 6 characters)",1,"form-control",3,"ngModelChange","ngModel"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","name","confirmPassword","required","","placeholder","Confirm your new password",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","submit",1,"btn-primary",3,"disabled"],["class","loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"loading-spinner"],[1,"success-message"],[1,"success-icon"],[1,"success-title"],[1,"success-text"],[1,"success-actions"],[1,"btn-primary",3,"click"],[1,"error-message"],[1,"error-icon"],[1,"error-title"],[1,"error-text"],[1,"error-actions"],[1,"btn-secondary",3,"click"],[1,"error-notification"]],template:function(o,i){o&1&&(e(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"span",5),r(5,"\u{1F4B0}"),t(),e(6,"h1",6),r(7,"Expense Tracker"),t()(),e(8,"p",7),r(9,"Set New Password"),t()(),h(10,B,17,5,"div",8)(11,G,10,0,"div",9)(12,H,10,0,"div",10)(13,J,2,1,"div",11),t()()),o&2&&(d(10),c("ngIf",!i.resetSuccess),d(),c("ngIf",i.resetSuccess),d(),c("ngIf",i.invalidCode),d(),c("ngIf",i.error))},dependencies:[O,M,D,q,T,V,N,F,j,A,z],styles:[".reset-password-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:1rem}.reset-password-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:2.5rem;box-shadow:0 20px 40px #0000001a;width:100%;max-width:450px}.reset-password-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.brand[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-bottom:1rem}.brand-icon[_ngcontent-%COMP%]{font-size:2rem}.brand-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#333;margin:0}.reset-password-subtitle[_ngcontent-%COMP%]{color:#666;margin:0;font-size:1rem}.instruction-text[_ngcontent-%COMP%]{color:#666;text-align:center;margin-bottom:1.5rem;line-height:1.5}.reset-form[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#333;margin-bottom:.5rem;font-size:.9rem}.form-control[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:2px solid #e9ecef;border-radius:12px;font-size:1rem;transition:all .3s ease;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-actions[_ngcontent-%COMP%]{margin-top:2rem}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #667eea4d}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:#495057;border:2px solid #e9ecef;border-radius:12px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #0000001a;border-color:#667eea;color:#667eea}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-message[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{text-align:center;padding:1rem 0}.success-icon[_ngcontent-%COMP%], .error-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;animation:_ngcontent-%COMP%_bounce .6s ease-in-out}.error-icon[_ngcontent-%COMP%]{color:#dc3545}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.success-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#28a745;margin:0 0 1rem}.error-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#dc3545;margin:0 0 1rem}.success-text[_ngcontent-%COMP%], .error-text[_ngcontent-%COMP%]{color:#666;margin:0 0 1.5rem;line-height:1.5}.success-actions[_ngcontent-%COMP%], .error-actions[_ngcontent-%COMP%]{margin-top:1.5rem}.error-notification[_ngcontent-%COMP%]{background:#fee;color:#c33;padding:.75rem 1rem;border-radius:8px;margin-top:1rem;text-align:center;border:1px solid #fcc}@media (max-width: 480px){.reset-password-card[_ngcontent-%COMP%]{padding:2rem 1.5rem}.brand-title[_ngcontent-%COMP%]{font-size:1.5rem}.success-icon[_ngcontent-%COMP%], .error-icon[_ngcontent-%COMP%]{font-size:2.5rem}.success-title[_ngcontent-%COMP%], .error-title[_ngcontent-%COMP%]{font-size:1.25rem}}"]})};export{L as ResetPasswordComponent};
