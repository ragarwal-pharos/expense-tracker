import{a as l}from"./chunk-HZAPKMB2.js";import{M as c,Q as g}from"./chunk-J6POWOXT.js";import{a as d,b as p,g as t}from"./chunk-RA2WU32H.js";var f=class n{constructor(r){this.firebaseService=r}getAll(){return t(this,null,function*(){return yield this.firebaseService.loadExpenses()})}add(r){return t(this,null,function*(){try{return yield this.firebaseService.addExpense(r)}catch(e){throw console.error("Error adding expense:",e),e}})}update(r){return t(this,null,function*(){try{yield this.firebaseService.updateExpense(r)}catch(e){throw console.error("Error updating expense:",e),e}})}delete(r){return t(this,null,function*(){try{yield this.firebaseService.deleteExpense(r)}catch(e){throw console.error("Error deleting expense:",e),e}})}deleteByCategoryId(r){return t(this,null,function*(){try{let o=(yield this.firebaseService.loadExpenses()).filter(i=>i.categoryId===r);for(let i of o)yield this.firebaseService.deleteExpense(i.id)}catch(e){throw console.error("Error deleting expenses by category:",e),e}})}getById(r){return t(this,null,function*(){return(yield this.firebaseService.loadExpenses()).find(o=>o.id===r)})}getByCategoryId(r){return t(this,null,function*(){return this.firebaseService.getExpensesByCategory(r)})}getByDateRange(r,e){return t(this,null,function*(){return this.firebaseService.getExpensesByDateRange(r,e)})}static \u0275fac=function(e){return new(e||n)(g(l))};static \u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})};var y=class n{constructor(r){this.firebaseService=r;this.initializeDefaultCategories()}initializeDefaultCategories(){return t(this,null,function*(){if((yield this.firebaseService.loadCategories()).length===0){let e=this.getDefaultCategories();for(let o of e)yield this.firebaseService.addCategory(o)}})}forceInitializeDefaultCategories(){return t(this,null,function*(){let r=this.getDefaultCategories();for(let e of r)yield this.firebaseService.addCategory(e)})}getDefaultCategories(){return[{name:"Food & Dining",color:"#A62C2C",icon:"\u{1F355}"},{name:"Transportation",color:"#E83F25",icon:"\u{1F699}"},{name:"Shopping",color:"#EA7300",icon:"\u{1F6D2}"},{name:"Entertainment",color:"#D3CA79",icon:"\u{1F3AD}"},{name:"Bills & Utilities",color:"#FF6B6B",icon:"\u26A1"},{name:"Healthcare",color:"#4ECDC4",icon:"\u{1F3E5}"},{name:"Education",color:"#45B7D1",icon:"\u{1F393}"},{name:"Rent/Mortgage",color:"#96CEB4",icon:"\u{1F3D8}\uFE0F"},{name:"Insurance",color:"#FF8E53",icon:"\u{1F6E1}\uFE0F"},{name:"Savings",color:"#2ECC71",icon:"\u{1F48E}"},{name:"Travel",color:"#9B59B6",icon:"\u2708\uFE0F"},{name:"Fitness & Sports",color:"#E74C3C",icon:"\u{1F3C3}"},{name:"Personal Care",color:"#F39C12",icon:"\u{1F484}"},{name:"Gifts & Donations",color:"#E91E63",icon:"\u{1F381}"},{name:"Technology",color:"#34495E",icon:"\u{1F4BB}"},{name:"Pet Care",color:"#8E44AD",icon:"\u{1F415}"},{name:"Other",color:"#95A5A6",icon:"\u{1F4CC}"}]}getAll(){return t(this,null,function*(){let r=yield this.firebaseService.loadCategories(),e=this.removeDuplicateCategories(r);return e.length!==r.length&&(yield this.cleanupDuplicateCategories(e)),e})}removeDuplicateCategories(r){let e=new Set,o=[];for(let i of r){let a=i.name.toLowerCase().trim();e.has(a)||(e.add(a),o.push(i))}return o}cleanupDuplicateCategories(r){return t(this,null,function*(){try{let e=yield this.firebaseService.loadCategories(),o=new Set,i=[];for(let a of e){let s=a.name.toLowerCase().trim();o.has(s)?i.push(a.id):o.add(s)}for(let a of i)try{yield this.firebaseService.deleteCategory(a)}catch(s){console.error(`Error deleting duplicate category ${a}:`,s)}}catch(e){console.error("Error cleaning up duplicate categories:",e)}})}add(r){return t(this,null,function*(){try{return yield this.firebaseService.addCategory(r)}catch(e){throw console.error("Error adding category:",e),e}})}update(r){return t(this,null,function*(){try{yield this.firebaseService.updateCategory(r)}catch(e){throw console.error("Error updating category:",e),e}})}delete(r){return t(this,null,function*(){try{let o=(yield this.firebaseService.loadExpenses()).filter(i=>i.categoryId===r);for(let i of o)yield this.firebaseService.deleteExpense(i.id);yield this.firebaseService.deleteCategory(r)}catch(e){throw console.error("Error deleting category:",e),e}})}getById(r){return t(this,null,function*(){return(yield this.firebaseService.loadCategories()).find(o=>o.id===r)})}triggerDuplicateCleanup(){return t(this,null,function*(){yield this.getAll()})}updateCategoryIcons(){return t(this,null,function*(){let r=yield this.getAll(),e={"Food & Dining":"\u{1F355}",Transportation:"\u{1F699}",Shopping:"\u{1F6D2}",Entertainment:"\u{1F3AD}","Bills & Utilities":"\u26A1",Healthcare:"\u{1F3E5}",Education:"\u{1F393}","Rent/Mortgage":"\u{1F3D8}\uFE0F",Insurance:"\u{1F6E1}\uFE0F",Savings:"\u{1F48E}",Travel:"\u2708\uFE0F","Fitness & Sports":"\u{1F3C3}","Personal Care":"\u{1F484}","Gifts & Donations":"\u{1F381}",Technology:"\u{1F4BB}","Pet Care":"\u{1F415}",Movie:"\u{1F3AC}",Loan:"\u{1F4B3}",SIP:"\u{1F4C8}","Street food":"\u{1F32E}",Snooker:"\u{1F3B1}",Tax:"\u{1F4CA}",Trips:"\u{1F9F3}",EMI:"\u{1F3E6}",Fuel:"\u26FD","Office canteen":"\u{1F37D}\uFE0F"},o=0;for(let i of r){let a=e[i.name];if(a&&i.icon!==a)try{let s=p(d({},i),{icon:a});yield this.update(s),o++}catch(s){console.error(`\u274C Error updating icon for "${i.name}":`,s)}}return o})}static \u0275fac=function(e){return new(e||n)(g(l))};static \u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})};export{f as a,y as b};
