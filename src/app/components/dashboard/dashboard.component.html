<div class="container-fluid px-4 py-3">
  <!-- Page Header -->
  <div class="page-header mb-4">
    <div class="d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center">
        <div class="header-icon me-3">
          <span class="fs-1">ğŸ“Š</span>
        </div>
        <div>
          <h1 class="page-title mb-1">Financial Dashboard</h1>
          <p class="text-muted mb-0">Your complete financial overview</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Summary Cards -->
  <div class="summary-cards mb-4">
    <div class="summary-card total-spent hover-lift">
      <div class="card-icon">ğŸ’¸</div>
      <div class="card-content">
        <h3 class="card-title">Total Spent</h3>
        <div class="card-amount">â‚¹{{ totalSpent | number }}</div>
        <div class="card-subtitle">{{ getFilterLabel() }}</div>
      </div>
    </div>
    
    <div class="summary-card monthly-spent hover-lift">
      <div class="card-icon">ğŸ“…</div>
      <div class="card-content">
        <h3 class="card-title">This Month</h3>
        <div class="card-amount">â‚¹{{ monthlyTotal | number }}</div>
        <div class="card-subtitle">Current Month</div>
      </div>
    </div>
    
    <div class="summary-card weekly-spent hover-lift">
      <div class="card-icon">ğŸ“Š</div>
      <div class="card-content">
        <h3 class="card-title">This Week</h3>
        <div class="card-amount">â‚¹{{ weeklyTotal | number }}</div>
        <div class="card-subtitle">Current Week</div>
      </div>
    </div>
  </div>

  <!-- Monthly Comparison -->
  <div class="monthly-comparison mb-4" *ngIf="getMonthlyComparison().hasPreviousData || monthlyTotal > 0">
    <div class="comparison-card">
      <div class="comparison-header">
        <h3>Monthly Comparison</h3>
        <span class="comparison-period">vs Last Month</span>
      </div>
      <div class="comparison-content">
        <div class="comparison-stat">
          <div class="stat-value" [class]="getMonthlyComparison().change < 0 ? 'positive' : 'negative'">
            {{ getMonthlyComparison().change | currency:'INR' }}
          </div>
          <div class="stat-label">Change</div>
        </div>
        <div class="comparison-stat">
          <div class="stat-value" [class]="getMonthlyComparison().percentage < 0 ? 'positive' : 'negative'">
            {{ getMonthlyComparison().percentage | number:'1.0-1' }}%
          </div>
          <div class="stat-label">Percentage</div>
        </div>
        <div class="comparison-stat">
          <div class="stat-value new-month" *ngIf="!getMonthlyComparison().hasPreviousData && monthlyTotal > 0">
            First Month
          </div>
          <div class="stat-label">Status</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Controls -->
  <div class="filter-controls mb-4">
    <div class="filter-buttons">
              <button class="filter-btn" 
                [class.active]="selectedPeriod === 'all'"
                (click)="selectedPeriod = 'all'; onFilterChange()">
          All Time
        </button>
        <button class="filter-btn" 
                [class.active]="selectedPeriod === 'monthly'"
                (click)="selectedPeriod = 'monthly'; onFilterChange()">
          Monthly
        </button>
        <button class="filter-btn" 
                [class.active]="selectedPeriod === 'yearly'"
                (click)="selectedPeriod = 'yearly'; onFilterChange()">
          Yearly
        </button>
        <button class="filter-btn" 
                [class.active]="selectedPeriod === 'custom'"
                (click)="selectedPeriod = 'custom'; onFilterChange()">
          Custom
        </button>
    </div>
    
    <!-- Custom Date Range Inputs -->
    <div class="custom-date-inputs" *ngIf="selectedPeriod === 'custom'">
      <div class="date-input-group">
        <label class="date-label">Start Date:</label>
        <input type="date" 
               class="date-input" 
               [(ngModel)]="customStartDate"
               (change)="onFilterChange()">
      </div>
      <div class="date-input-group">
        <label class="date-label">End Date:</label>
        <input type="date" 
               class="date-input" 
               [(ngModel)]="customEndDate"
               (change)="onFilterChange()">
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-content">
    <div class="content-grid">
      <!-- Category Breakdown - Rebuilt from scratch -->
      <div class="content-card category-section">
        <div class="card-header">
          <div class="header-left">
            <span class="header-icon">ğŸ·ï¸</span>
            <h5 class="header-title">Category-wise Spending</h5>
          </div>
          <div class="header-right">
            <span class="filter-period">{{ getFilterLabel() }}</span>
            <span class="total-amount">â‚¹{{ getFilteredTotal() | number }}</span>
          </div>
        </div>
        
        <div class="card-body">
          <div class="category-list" *ngIf="categories.length > 0">
            <div class="category-item" *ngFor="let category of categories">
              <div class="category-info">
                <div class="category-icon" [style.background-color]="category?.color || '#999'">
                  {{ category?.icon || 'ğŸ“Œ' }}
                </div>
                <div class="category-details">
                  <div class="category-name">{{ category?.name || 'Unknown' }}</div>
                  <div class="category-count">
                    {{ getExpensesByCategory(category?.id || '').length }} expenses
                  </div>
                </div>
              </div>
              <div class="category-amount">
                â‚¹{{ categoryTotals[category?.id || ''] || 0 | number }}
              </div>
            </div>
          </div>
          
          <div class="empty-state" *ngIf="categories.length === 0">
            <div class="empty-icon">ğŸ·ï¸</div>
            <h6>No Categories Found</h6>
            <p>Add some categories to start tracking your expenses!</p>
          </div>
        </div>
      </div>

      <!-- Recent Expenses - Rebuilt from scratch -->
      <div class="content-card recent-section">
        <div class="card-header">
          <div class="header-left">
            <span class="header-icon">ğŸ“</span>
            <h5 class="header-title">Recent Expenses</h5>
          </div>
        </div>
        
        <div class="card-body">
          <div class="expenses-list" *ngIf="getFilteredExpenses().length > 0">
            <div class="expense-item" *ngFor="let expense of getFilteredExpenses().slice(0, 5)">
              <div class="expense-info">
                <div class="expense-icon" [style.background-color]="getCategoryColor(expense.categoryId)">
                  {{ getCategoryIcon(expense.categoryId) }}
                </div>
                <div class="expense-details">
                  <div class="expense-description">{{ expense.description || 'No description' }}</div>
                  <div class="expense-date">{{ expense.date | date:'MMM dd' }}</div>
                </div>
              </div>
              <div class="expense-amount">â‚¹{{ expense.amount | number }}</div>
            </div>
          </div>
          
          <div class="empty-state" *ngIf="getFilteredExpenses().length === 0">
            <div class="empty-icon">ğŸ“</div>
            <h6>No Expenses Found</h6>
            <p>Add some expenses to see them here!</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

 